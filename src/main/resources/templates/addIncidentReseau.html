<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Créer un incident du réseau</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/boosted@5.2.3/dist/css/boosted.min.css" rel="stylesheet"
        integrity="sha384-zYFw+mxKy6r9zpAc1NoGiYBfQmxfvg7ONEMr81WeU+WLPPaLC9QTrNGFJTBi3EIn" crossorigin="anonymous">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/boosted@5.2.3/dist/js/boosted.bundle.min.js"
        integrity="sha384-MANW37RG4MpFWPMCcNZBnvSobOkBpIGlbBkEzTtD4FbbOzJXbW8TddND1ak2lfsB"
        crossorigin="anonymous"></script>
    <!-- <script src="https://unpkg.com/unpoly@2.7.2/unpoly.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/unpoly@2.7.2/unpoly.min.css"> -->
</head>

<body>


    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <div class="navbar-brand">
                <a class="stretched-link" href="#">
                    <img src="http://localhost:8080/orange-logo.svg" alt="Boosted - Back to Home" loading="lazy" width="50" height="50">
                </a>
                <h1 class="title">Orange</h1>
            </div>
    
            <!-- new code -->
    
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarScroll"
                aria-controls="navbarScroll" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse align-items-end" id="navbarScroll">
                <ul class="navbar-nav me-auto my-2 my-lg-0 navbar-nav-scroll align-items-end"
                    style="--bs-scroll-height: 100px;">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="/accueil">Accueil</a>
                    </li>
    
    
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Reporting
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark">
                            <li><a href="/reporting/reseau" class="dropdown-item">Tickets liés au réseau</a></li>
                            <!-- <li><a href="/reportingService" class="dropdown-item" >Tickets liés aux services</a></li> -->
                            <li><a href="/servweeklyreporting" class="dropdown-item">Tickets liés aux services</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Incident
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark">
                            <li><a href="/incidents" class="dropdown-item" >Liste de tous les incidents en
                                    cours</a></li>
                            <li><a href="/incidents/reseau" class="dropdown-item">Création d'incident du réseau</a></li>
                            <li><a href="/incidents/service" class="dropdown-item">Création d'incident de service</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Administration
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark">
                            <li><a href="/sites" class="dropdown-item">Administration des sites</a></li>
                            <li><a href="/incidents/reseau" class="dropdown-item" >Administration des
                                    utilisateur</a></li>
                            <li><a href="/services" class="dropdown-item" >Administration des services</a></li>
                        </ul>
                    </li>
                </ul>
    
            </div>
            <ul class="nav fixed-top justify-content-center">
    
    
            </ul>
        </div>
    
    </nav>





    <div class="container-fluid content">
        <div class="alert alert-success" role="alert" id="suc">
            <span class="alert-icon"><span class="visually-hidden">Success</span></span>
            <p>Ticket enregistré avec succès.</p>
        </div>
        <div class="alert alert-danger" role="alert" id="err">
            <span class="alert-icon"><span class="visually-hidden">Error</span></span>
            <p>Echec de l'enregistrement du ticket.</p>
        </div>
        <!-- <h1>Incident réseau</h1> -->
        <form id="form" method="post"
            action="{#if !isUpdate}/incidents/reseau{#else}/incidents/reseau/{incident.id} {/if}" up-submit>
            <fieldset>
                <legend class=" legende">Créer un incident du réseau</legend>
                <div class="mb-3">
                    <label for="criticality" class="form-label is-required">Niveau de criticité</label>
                    <select name="criticality" id="criticality">
                        <option value="CRITIQUE">Critique</option>
                        <option value="MOYEN">Moyen</option>
                        <option value="FAIBLE">Faible</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="nursingle" class="form-label is-required">Problème</label>
                    <select name="nursingle" id="nursingle">
                        <optgroup label="energy">
                            {#for energy in energies}
                            <option value="{energy.id}">{energy.name}</option>
                            {/for}
                        </optgroup>
                        <optgroup label="transmission">
                            {#for transmission in transmissions}
                            <option value="{transmission.id}">{transmission.name}</option>
                            {/for}
                        </optgroup>
                        <optgroup label="system">
                            {#for system in systems}
                            <option value="{system.id}">{system.name}</option>
                            {/for}
                        </optgroup>
                        <optgroup label="work">
                            {#for work in works}
                            <option value="{work.id}">{work.name}</option>
                            {/for}
                        </optgroup>
                        <optgroup label="other">
                            {#for other in others}
                            <option value="{other.id}">{other.name}</option>
                            {/for}
                        </optgroup>
                        <optgroup label="disaster">
                            {#for disaster in disasters}
                            <option value="{disaster.id}">{disaster.name}</option>
                            {/for}
                        </optgroup>
                        <optgroup label="insecurities">
                            {#for insecuritiy in insecurities}
                            <option value="{insecuritiy.id}">{insecuritiy.name}</option>
                            {/for}
                        </optgroup>
                    </select>
                    <div class="mb-3">
                        <input type="hidden" class="form-control" id="type" name="type" value="1">
                    </div>
                </div>
                <div class="mb-3">
                    <label for="responsable" class="form-label is-required">Responsable</label>
                    <input type="text" class="form-control" id="responsable" name="responsable">
                </div>
                <div class="mb-3">
                    <label for="cause" class="form-label is-required">Cause</label>
                    <input type="text" class="form-control" id="cause" name="cause">
                </div>
                <div class="mb-3">
                    <div class="form-group">
                        <label for="start-date" class="form-label is-required">Date de début</label>
                        <input type="datetime-local" class="form-control" id="start-date" name="start-date">
                    </div>
                </div>
                {#if isUpdate}
                <div class="mb-3">
                    <label for="end-date" class="form-label">Date de fin</label>
                    <input type="datetime-local" class="form-control" id="end-date" name="end-date">
                </div>
                {/if}
                <div class="mb-3">
                    <label for="resolution" class="form-label is-required">Résolution</label>
                    <input type="text" class="form-control" id="resolution" name="resolution">
                </div>
                <div class="mb-3">
                    <input type="hidden" class="form-control" id="type" name="type" value="1">
                </div>
                <div class="mb-3">
                    <label for="resolution" class="form-label is-required">Statut</label>
                    <select name="status" id="status">
                        <option value="EN_COURS">En cours</option>
                        <option value="TERMINE">Terminé</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="site" class="form-label is-required">Site</label>
                    <select name="site" id="site" class="form-select" aria-label="size 3 select example">
                        {#for site in sites}
                        <option value="{site.id}">{site.name}</option>
                        {/for}
                    </select>
                </div>
                <!-- Button trigger the modal -->
                <button type="submit" class="btn btn-primary" id="submit">
                    Valider
                </button>
                <!-- Modal -->
                <!-- <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title h5" id="staticBackdropLabel">Est-ce que toutes les informations sont valides ?</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal"><span class="visually-hidden">Close</span></button>
              </div>
              <div class="modal-body">
                Cliquez sur <strong>enregistrer</strong> pour enregistrer l'incident sans envoyer de mail.<br/>
                Cliquez sur <strong>enregistrer et envoyer</strong> pour enregistrer l'incident puis envoyer de mail.
              </div>
              <div class="modal-footer">
                <button type="submit" class="btn btn-secondary" data-bs-dismiss="modal" id="submit">Valider</button>
                <button type="button" class="btn btn-primary">Enregistrer & Envoyer</button>
              </div>
            </div>
          </div> -->
    </div>






    <!-- <button type="submit" class="btn btn-primary mt-2">Submit</button> -->
    </fieldset>
    </form>
    </div>

    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"
        integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#err").hide();
            $("#suc").hide();
            $("#submit").click(function (e) {
                e.preventDefault();
                var cause = $("#cause").val();
                var startDate = $("#start-date").val();
                var resolution = $("#resolution").val();
                var criticality = $("#criticality").val();
                var status = $("#status").val();
                var site = $("#site").val();

                var inc = {
                    "cause": cause,
                    "start-date": startDate,
                    "resolution": resolution,
                    "criticality": criticality,
                    "status": status,
                    "site": site
                }

                $.ajax({
                    url: "/incidents/reseau",
                    type: "POST",
                    data: JSON.stringify(inc),
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                }).done(function (d) {
                    $("#result").removeClass("hidden").show();
                    $(".message").html(d.message);
                    if (d.success) {
                        $("#err").hide();
                        $("#suc").show();
                    } else {
                        console.log("failure");
                        $("#err").show();
                        $("#suc").hide();
                    }
                }).fail(function () {
                    $("#result").removeClass("hidden").show();
                    $(".message").html("Unable to call the server");
                    $("#err").show();
                    $("#suc").hide();
                });
            });
        })
    </script>



    <!-- <form method="post" action="/incidents/reseau">
        Cause
        <input type="text" name="cause"><br>
        Date de début
        <input type="datetime-local" name="start-date" ><br>
        Date de fin
        <input type="datetime-local" name="end-date" ><br>
        Résolution
        <input type="text" name="resolution"/><br>
        Site
        <select name="site" id="site">
          {#for site in sites}
          <option value="{site.id}">{site.name}</option>
          {/for}
        </select>
        <input type="submit" value="Valider">
   </form> -->

</body>

</html>